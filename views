db.createView(
   "leader_board",
   "users",
   [
   {$unwind : "$flights" },
{
		$lookup:{
			from : "flights",
			localField : "flights.flight_id",
			foreignField : "_id",
			as : "flight_info"
		}
	},
{$unwind : "$flight_info" },
{
$group : {
           _id : "$_id",
           duration: { $sum: "$flight_info.duration" },
           name: {$first: "$name"}
        }
},
{$sort: {duration: -1}}
   ]
)
